<html>
	<head>
		<style type="text/css">
			body {
				background: #ccc;
			}
			svg {
				background: #fff;
			}
			#test {
				width: 100px;
				height: 20px;
			}

			#debug {
				height: 200px;
			}
		</style>

		<script>
		function convertColors() {
			var hexcolors = [];
			var rgbcolors = [];

			var svg = document.getElementsByTagName('svg')[0];
			var boxes = svg.getElementsByTagName('rect');
			
			// store hex colors in array
			for (var i = 0; i < boxes.length; i++) {
				hexcolors[i] = boxes[i].style['fill'];
				rgbcolors.push(hext2rgb(hexcolors[i]));
			}

			document.getElementById("debug").value = writeGPLFormat("test", rgbcolors);

		}


		function hext2rgb(h) {
			// expecting the hex value to start with '#'. if it be like it don't, shit the bed and go home unseen.
			if(h.substring(0,1) !== '#') {
				console.log('oh shit.');
				return;
			}
			h = h.substring(1,6);
			var r = parseInt(h.substring(0,2),16);
			var g = parseInt(h.substring(2,4),16);
			var b = parseInt(h.substring(4,6),16);
			return r + ' ' + g + ' ' + b;
		}

		function writeGPLFormat(name, colors){
			var fileheader = '';
			var colorvalues = '';
			var output = ''

			fileheader += 'GIMP Palette' + '\n';
			fileheader += 'Name: ' + name + '\n';
			fileheader += 'Columns: ' + name + '\n';
			fileheader += '#\n';

			for (var i=0; i<colors.length; i++) {
				colorvalues += colors[i] + '\n';
			}

			output = fileheader + colorvalues;
			return output;

		}

		</script>

	</head>
	<body>
		
		<h4>Swatcheroo</h4>
		<p><a href="http://www.inkscape.org">Inkscape</a> uses GIMP Pallette (.gpl) files to build palettes.</p>
		<p>Swatcheroo is an experiment to read an svg file and create a color swatch / palette out of rectangle elements contained in it.</p>

		
		<textarea id="debug"></textarea>
		<hr />
		<h6>SVG File:</h6>
		<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="100" height="100" version="1.1" inkscape:version="0.48.2 r9819">
		  <defs/>
		  <metadata>
		    <rdf:RDF>
		      <cc:Work rdf:about="">
		        <dc:format>image/svg+xml</dc:format>
		        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
		        <dc:title/>
		      </cc:Work>
		    </rdf:RDF>
		  </metadata>
		  <g inkscape:label="Layer 1" inkscape:groupmode="layer" transform="translate(0,0)">
			<rect
			     style="color:#000000;fill:#990000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate"
			     id="rect3008"
			     width="20"
			     height="20"
			     x="0"
			     y="0" />
			  <rect
			     y="25"
			     x="0"
			     height="20"
			     width="20"
			     id="rect3010"
			     style="color:#000000;fill:#ff9933;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate" />
			  <rect
			     style="color:#000000;fill:#ffff00;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate"
			     id="rect3859"
			     width="20"
			     height="20"
			     x="0"
			     y="50" />
			  <rect
			     y="75"
			     x="0"
			     height="20"
			     width="20"
			     id="rect3861"
			     style="color:#000000;fill:#99ff66;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate" />
			  <rect
			     style="color:#000000;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate"
			     id="rect3867"
			     width="20"
			     height="20"
			     x="25"
			     y="0" />
			  <rect
			     y="25"
			     x="25"
			     height="20"
			     width="20"
			     id="rect3869"
			     style="color:#000000;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate" />
			  <rect
			     style="color:#000000;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate"
			     id="rect3871"
			     width="20"
			     height="20"
			     x="25"
			     y="50" />
			  <rect
			     y="75"
			     x="25"
			     height="20"
			     width="20"
			     id="rect3873"
			     style="color:#000000;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate" />
			 
		  </g>
		</svg>
		<script>
			convertColors();	
		</script>
	</body>
</html>
